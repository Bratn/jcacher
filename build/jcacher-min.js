(function(){function a(b){return new wrapper(b)}if("undefined"!==typeof exports){if("undefined"!==typeof module&&module.k)exports=module.k=a;exports.q=a}else"function"===typeof define&&define.p?define("jcacher",function(){return a}):this.jCacher=a;var f=[];a.VERSION="2.0";a.count=0;a.c={EXPIRED:"expired",REMOVED:"removed",DEPENDENCY_CHANGED:"dependencyChanged"};a.add=function(b,c,d,e){c=c instanceof a.CacheItem?c:new a.CacheItem(b,c,d);a.count+=f[b]?0:1;f[b]=c;if(e){b=0;for(d=e.length;b<d;b++){var j=
f[e[b]];if(!j){a.remove(c,a.c.i);break}j.f.push(c.key)}}};a.get=function(b){b=f[b];return!b?null:b.l()};a.remove=function(b,c,d){b=b instanceof a.CacheItem?b:f[b];if("undefined"==b)return!1;delete f[b.key];a.count--;g.m("removed",b,c||a.c.o,d);c=0;for(d=b.f.length;c<d;c++)a.remove(b.f[c],a.c.i);return!0};a.reset=function(){for(var b in f)a.remove(b)};a.removed=function(b){g.bind("removed",b,a)};a.CacheItem=function(b,c,d){var e=a.CacheItem.defaults;if("Object"==typeof d)e.a="undefined"!=d.a?d.a:e.a,
e.b="undefined"!=d.b?d.b:e.b,e.removed=d.removed?d.removed:e.removed;this.key=b;this.f=[];this.d=e;this.j=c;this.e=null;this.h()};a.CacheItem.defaults={a:60,b:60,removed:a.removed};a.CacheItem.prototype={l:function(){this.d.a&&this.h();return this.j},h:function(){var b=this;b.e&&clearTimeout(b.e);var c=b.d.a||b.d.b||null;if(null!==c)b.e=setTimeout(function(){a.remove(b,a.c.n)},1E3*c)}};var g={bind:function(b,c,a){var e=this.g||(this.g={});(e[b]||(e[b]=[])).push([c,a]);return this},m:function(b){var a,
d,e,f,i=2;if(!(d=this.g))return this;for(;i--;)if(a=i?b:"all",a=d[a])for(var h=0,g=a.length;h<g;h++)(e=a[h])?(f=i?Array.prototype.slice.call(arguments,1):arguments,e[0].apply(e[1]||this,f)):(a.splice(h,1),h--,g--);return this}};if(!Array.prototype.indexOf)Array.prototype.indexOf=function(b,a){for(var a=a||0,d=this.length;a<d;){if(this[a]===b)return a;++a}return-1}}).call(this);
